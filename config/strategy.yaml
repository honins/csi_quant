# ============================================================================
# CSI1000量化交易策略配置文件
# ============================================================================
# 本配置文件包含了量化交易策略的所有参数设置，包括：
# 1. 策略参数优化配置
# 2. 人工智能算法配置 
# 3. 策略权重和阈值设置
# 4. 回测和验证参数
# ============================================================================

# 🔧 高级优化配置
# 启用高级优化功能，包括分层优化、高精度模式等
advanced_optimization:
  enabled: true                    # 是否启用高级优化
  high_precision_mode: true        # 高精度模式，提高计算精度
  use_hierarchical: true           # 使用分层优化策略
  use_scipy: true                  # 使用SciPy优化算法
  use_time_series_cv: true         # 使用时间序列交叉验证

# 🎯 AI评分系统配置
# 用于评估策略性能的多维度评分体系
ai_scoring:
  rise_benchmark: 0.1              # 涨幅基准值（10%）
  rise_weight: 0.25                # 涨幅权重
  risk_benchmark: 0.2              # 风险基准值
  risk_weight: 0.1                 # 风险权重
  speed_weight: 0.15               # 速度权重（达到目标涨幅的时间）
  success_weight: 0.5              # 成功率权重

# 🔍 贝叶斯优化配置
# 使用贝叶斯优化算法进行参数搜索
bayesian_optimization:
  acq_func: EI                     # 采集函数：Expected Improvement
  enabled: true                    # 是否启用贝叶斯优化
  kappa: 2.0                       # UCB采集函数的探索参数
  n_calls: 120                     # 优化调用次数
  n_initial_points: 25             # 初始随机采样点数
  n_jobs: 1                        # 并行作业数
  random_state: 42                 # 随机种子，确保结果可重现
  xi: 0.008                        # EI采集函数的探索参数

# 🎲 置信度标准差阈值
# 用于判断置信度的稳定性
confidence_std_threshold: 0.05

# ⚖️ 置信度权重配置
# 各个技术指标在最终决策中的权重设置
confidence_weights:
  # 布林带相关参数
  bb_lower_near: 0.32              # 价格接近布林带下轨的权重
  bb_near_threshold: 1.018         # 布林带接近阈值（1.8%以内）
  
  # 整理突破相关
  consolidation_breakout: 0.22     # 横盘整理突破权重
  decline_threshold: -0.048        # 下跌阈值（-4.8%）
  
  # 动态调整参数
  dynamic_confidence_adjustment: 0.12  # 动态置信度调整权重
  final_threshold: 0.15            # 最终决策阈值
  
  # 均线相关参数
  ma_all_below: 0.42               # 价格跌破所有均线权重
  ma_partial_below: 0.22           # 价格跌破部分均线权重
  
  # MACD相关参数
  macd_negative: 0.18              # MACD负值权重
  macd_rsi_combo: 0.15             # MACD-RSI组合信号权重
  
  # 市场情绪和动量
  market_sentiment_weight: 0.18    # 市场情绪权重
  moderate_rsi_bonus: 0.3          # 适中RSI奖励权重
  momentum_reversal_bonus: 0.28    # 动量反转奖励权重
  
  # 价格相关参数
  price_decline_threshold: -0.018  # 价格下跌阈值（-1.8%）
  price_momentum_weight: 0.22      # 价格动量权重
  recent_decline: 0.32             # 近期下跌权重
  
  # 阻力和支撑
  resistance_break_bonus: 0.3      # 突破阻力位奖励
  support_level_bonus: 0.25        # 支撑位奖励
  
  # RSI相关参数
  rsi_low: 0.22                    # RSI偏低权重
  rsi_low_threshold: 42.0          # RSI偏低阈值
  rsi_overbought_correction: 0.35  # RSI超买修正权重
  rsi_oversold: 0.42               # RSI超卖权重
  rsi_oversold_threshold: 22.0     # RSI超卖阈值
  rsi_pullback_threshold: 2        # RSI回调阈值
  rsi_uptrend_max: 85              # 上升趋势中RSI最大值
  rsi_uptrend_min: 30              # 上升趋势中RSI最小值
  rsi_uptrend_pullback: 0.45       # 上升趋势回调权重
  
  # 趋势相关参数
  trend_strength_weight: 0.14      # 趋势强度权重
  uptrend_consolidation_bonus: 0.28 # 上升趋势整理奖励
  uptrend_ma_support: 0.32         # 上升趋势均线支撑权重
  uptrend_pullback_bonus: 0.35     # 上升趋势回调奖励
  uptrend_support_volume: 0.15     # 上升趋势支撑成交量权重
  uptrend_volume_pullback: 0.2     # 上升趋势成交量回调权重
  
  # 成交量相关参数
  volume_panic_bonus: 0.18         # 成交量恐慌奖励权重
  volume_panic_threshold: 1.45     # 成交量恐慌阈值（45%以上）
  volume_price_divergence: 0.2     # 价量背离权重
  volume_shrink_penalty: 0.68      # 成交量萎缩惩罚权重
  volume_shrink_threshold: 0.78    # 成交量萎缩阈值（78%以下）
  volume_surge_bonus: 0.12         # 成交量激增奖励权重
  volume_surge_threshold: 1.25     # 成交量激增阈值（25%以上）
  volume_weight: 0.35              # 总成交量权重

# 🛑 早停配置
# 防止过度训练的早停机制
early_stopping:
  enabled: true                    # 是否启用早停
  min_delta: 0.0008               # 最小改进幅度
  patience: 60                     # 容忍轮数

# ⚙️ 执行配置
# 策略执行相关的基础配置
execution:
  data_decay_rate: 0.35           # 数据衰减率
  optimization_interval: 30       # 优化间隔（天）
  parallel_jobs: 1                # 并行作业数
  save_intermediate: false        # 是否保存中间结果
  save_results: true              # 是否保存最终结果
  train_test_split_ratio: 0.8     # 训练测试集分割比例
  use_multiprocessing: false      # 是否使用多进程

# 🧬 遗传算法配置
# 遗传算法参数优化配置
genetic_algorithm:
  crossover_rate: 0.8             # 交叉率
  elite_ratio: 0.1                # 精英保留比例
  enabled: true                   # 是否启用遗传算法
  generations: 25                 # 进化代数
  mutation_rate: 0.15             # 变异率
  population_size: 300            # 种群大小

# 🎛️ 优化配置
# 全局优化相关配置
optimization:
  enable_history: true            # 是否启用历史记录
  enable_incremental: true        # 是否启用增量优化
  global_iterations: 600          # 全局迭代次数
  incremental_contraction_factor: 0.45  # 增量收缩因子
  incremental_iterations: 1200    # 增量迭代次数
  max_history_records: 150        # 最大历史记录数

# 📊 参数优化范围
# 定义需要优化的参数及其取值范围
# 注意：参数过多会导致优化时间过长和过拟合风险
optimization_ranges:
  # 🔥 核心决策参数（3个）- 最重要，每次预测都使用
  final_threshold:                # 最终置信度阈值
    max: 0.35                     # 最大值：35%
    min: 0.15                     # 最小值：15%
    step: 0.02                    # 步长：2%
  rsi_oversold_threshold:         # RSI超卖阈值
    max: 35                       # 最大值：35
    min: 25                       # 最小值：25
    step: 1                       # 步长：1
  rsi_low_threshold:              # RSI偏低阈值
    max: 50                       # 最大值：50
    min: 40                       # 最小值：40
    step: 1                       # 步长：1
  
  # 🔥 基础权重参数（4个）- 高频使用，重要逻辑
  ma_all_below:                   # 价格跌破所有均线权重
    max: 0.4                      # 最大值：40%
    min: 0.2                      # 最小值：20%
    step: 0.02                    # 步长：2%
  dynamic_confidence_adjustment:  # 动态置信度调整
    max: 0.25                     # 最大值：25%
    min: 0.05                     # 最小值：5%
    step: 0.02                    # 步长：2%
  market_sentiment_weight:        # 市场情绪权重
    max: 0.25                     # 最大值：25%
    min: 0.08                     # 最小值：8%
    step: 0.02                    # 步长：2%
  trend_strength_weight:          # 趋势强度权重
    max: 0.25                     # 最大值：25%
    min: 0.1                      # 最小值：10%
    step: 0.02                    # 步长：2%
  
  # 🔥 成交量逻辑参数（4个）- 代码中大量使用的核心逻辑
  volume_panic_threshold:         # 成交量恐慌阈值
    max: 2.0                      # 最大值：200%（2倍成交量）
    min: 1.2                      # 最小值：120%
    step: 0.05                    # 步长：5%
  volume_panic_bonus:             # 成交量恐慌奖励权重
    max: 0.2                      # 最大值：20%
    min: 0.05                     # 最小值：5%
    step: 0.02                    # 步长：2%
  volume_surge_bonus:             # 成交量激增奖励权重
    max: 0.15                     # 最大值：15%
    min: 0.02                     # 最小值：2%
    step: 0.02                    # 步长：2%
  volume_shrink_penalty:          # 成交量萎缩惩罚权重
    max: 0.8                      # 最大值：80%
    min: 0.5                      # 最小值：50%
    step: 0.05                    # 步长：5%
  
  # 🔥 技术指标参数（4个）- 基础但重要的技术指标
  bb_near_threshold:              # 布林带接近阈值
    max: 1.05                     # 最大值：105%（5%以内）
    min: 1.005                    # 最小值：100.5%（0.5%以内）
    step: 0.005                   # 步长：0.5%
  recent_decline:                 # 近期下跌权重
    max: 0.3                      # 最大值：30%
    min: 0.1                      # 最小值：10%
    step: 0.02                    # 步长：2%
  macd_negative:                  # MACD负值权重
    max: 0.15                     # 最大值：15%
    min: 0.05                     # 最小值：5%
    step: 0.02                    # 步长：2%
  price_decline_threshold:        # 价格下跌阈值
    max: -0.01                    # 最大值：-1%
    min: -0.06                    # 最小值：-6%
    step: 0.005                   # 步长：0.5%

# 🚨 过拟合阈值
# 用于检测和防止模型过拟合
overfitting_threshold: 0.9

# 📈 策略参数
# 当前最优的策略参数配置
strategy:
  bb_near_threshold: 1.01049      # 布林带接近阈值（优化后）
  confidence_weights:             # 置信度权重（优化后）
    dynamic_confidence_adjustment: 0.2384
    final_threshold: 0.25
    ma_all_below: 0.35
    market_sentiment_weight: 0.1767
    rsi_low_threshold: 45.0
    rsi_oversold: 0.35
    rsi_oversold_threshold: 30.0
    trend_strength_weight: 0.16
    volume_weight: 0.3
  dynamic_confidence_adjustment: 0.2169  # 动态置信度调整（优化后）
  market_sentiment_weight: 0.3074       # 市场情绪权重（优化后）
  max_days: 20                          # 最大持有天数（固定参数）
  price_momentum_weight: 0.2766         # 价格动量权重（优化后）
  rise_threshold: 0.035                 # 涨幅阈值（固定参数：3.5%）
  trend_strength_weight: 0.1035         # 趋势强度权重（优化后）
  volume_panic_threshold: 1.3           # 成交量恐慌阈值（优化后）
  volume_shrink_threshold: 0.573        # 成交量萎缩阈值（优化后）
  volume_surge_threshold: 1.15          # 成交量激增阈值（优化后）
  volume_weight: 0.3287                 # 成交量权重（优化后）

# 📊 策略范围（备用配置）
# 策略参数的基础范围，用于简单优化
strategy_ranges:
  final_threshold:
    max: 0.6
    min: 0.25
    step: 0.02
  max_days:
    max: 30
    min: 10
    step: 1
  rise_threshold:
    max: 0.08
    min: 0.03
    step: 0.005
  rsi_low_threshold:
    max: 48
    min: 38
    step: 1
  rsi_oversold_threshold:
    max: 38
    min: 28
    step: 1

# 🏆 策略评分配置
# 用于评估策略表现的评分体系
strategy_scoring:
  days_benchmark: 10.0            # 天数基准值
  days_weight: 0.2                # 天数权重
  rise_benchmark: 0.1             # 涨幅基准值（10%）
  rise_weight: 0.3                # 涨幅权重
  success_weight: 0.5             # 成功率权重

# ✅ 验证配置
# 模型验证和回测相关配置
validation:
  test_ratio: 0.15                # 测试集比例（15%）
  train_ratio: 0.65               # 训练集比例（65%）
  validation_ratio: 0.2           # 验证集比例（20%）
  walk_forward:                   # 滚动前向验证
    enabled: true                 # 是否启用
    step_size: 63                 # 步长（约3个月）
    window_size: 252              # 窗口大小（约1年）

# 🚫 零置信度阈值
# 当置信度低于此值时，不触发交易信号
zero_confidence_threshold: 0.5
